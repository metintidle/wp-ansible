---
- name: Setup Nginx and PHP on Amazon Linux 2 (512MB RAM) For WordPress
  hosts: all
  become: yes

  vars:
    web_user: "{{ ansible_user | default('ec2-user') }}"

  tasks:

  # Wordpress and plugins has issue with upper than PHP version 8.1
  # memory regression issues on v 8.4
  # plugin ecosystem incompatibilities make it unsuitable for production use on resource-constrained servers
  - name: Install PHP and PHP-FPM dependencies
    dnf:
      name:
      - gcc
      - ImageMagick
      - ImageMagick-devel
      - libwebp-tools
      - netpbm-progs
      - libjpeg-turbo-utils
      state: present