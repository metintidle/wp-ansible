# Strict path whitelist - Deny rule (server context)
# Deploy to: /etc/nginx/default.d/00-strict-whitelist.conf
#
# Requires: /etc/nginx/conf.d/strict-whitelist-maps.conf (maps must be loaded first)
#
# Purpose: Block anonymous requests that don't match the whitelist.
# Logged-in users bypass this entirely (handled by $strict_skip in maps).

# Block request if not logged in AND not in whitelist
if ($strict_deny = 1) {
  return 403;
}
